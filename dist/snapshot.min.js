var snapshot=function(e,t,n,a,r,s,i,o,c,u,p,l,d){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
function f(e,t,n,a){return new(n||(n=Promise))((function(r,s){function i(e){try{c(a.next(e))}catch(e){s(e)}}function o(e){try{c(a.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}c((a=a.apply(e,t||[])).next())}))}function h(e,t){var n,a,r,s,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(r=2&s[0]?a.return:s[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,s[1])).done)return r;switch(a=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,a=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(r=i.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){i.label=s[1];break}if(6===s[0]&&i.label<r[1]){i.label=r[1],r=s;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(s);break}r[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],a=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}}function m(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),r=0;for(t=0;t<n;t++)for(var s=arguments[t],i=0,o=s.length;i<o;i++,r++)a[r]=s[i];return a}e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e,s=s&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s,u=u&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u,d=d&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d;var y=[{constant:!0,inputs:[{components:[{name:"target",type:"address"},{name:"callData",type:"bytes"}],name:"calls",type:"tuple[]"}],name:"aggregate",outputs:[{name:"blockNumber",type:"uint256"},{name:"returnData",type:"bytes[]"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"addr",type:"address"}],name:"getEthBalance",outputs:[{name:"balance",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"}],b={1:"https://api.thegraph.com/subgraphs/name/balancer-labs/balancer-beta",42:"https://api.thegraph.com/subgraphs/name/balancer-labs/balancer-kovan"};function v(e,t){return(e.args||["%{address}"]).map((function(e){return"string"==typeof e?e.replace(/%{address}/g,t):e}))}var g=[{constant:!0,inputs:[{internalType:"address",name:"account",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"}];function w(e,t,n,a,r,s){return f(this,void 0,void 0,(function(){var e,i;return h(this,(function(c){switch(c.label){case 0:return e="number"==typeof s?s:"latest",[4,H(t,n,g,a.map((function(e){return[r.address,"balanceOf",[e]]})),{blockTag:e})];case 1:return i=c.sent(),[2,Object.fromEntries(i.map((function(e,t){return[a[t],parseFloat(o.formatUnits(e.toString(),r.decimals))]})))]}}))}))}function k(e,t,n,a,r,s){return f(this,void 0,void 0,(function(){var n,r,i;return h(this,(function(o){switch(o.label){case 0:return n={delegations:{__args:{where:{delegate_in:a.map((function(e){return e.toLowerCase()})),delegator_not_in:a.map((function(e){return e.toLowerCase()})),space_in:["",e]},first:1e3},delegator:!0,space:!0,delegate:!0}},"latest"!==s&&(n.delegations.__args.block={number:s}),[4,N(G[t],n)];case 1:return(r=o.sent())&&r.delegations?(i={},r.delegations.forEach((function(e){return i[e.delegator]=e.delegate})),r.delegations.filter((function(e){return""!==e.space})).forEach((function(e){return i[e.delegator]=e.delegate})),[2,Object.fromEntries(a.map((function(e){return[e,Object.entries(i).filter((function(t){var n=t[1];return e.toLowerCase()===n})).map((function(e){return e[0]}))]})))]):[2,{}]}}))}))}var T={1:"0x9ef05f7f6deb616fd37ac3c959a2ddd25a54e4f5"},x=[{constant:!0,inputs:[{name:"",type:"address"}],name:"deposits",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"}];var E={1:"0x1f9840a85d5af5bf1d1762f925bdaddc4201f984"},S=[{constant:!0,inputs:[{internalType:"address",name:"account",type:"address"}],name:"getCurrentVotes",outputs:[{internalType:"uint96",name:"",type:"uint96"}],payable:!1,stateMutability:"view",type:"function"}];var O=[{constant:!0,inputs:[],name:"getPricePerFullShare",outputs:[{internalType:"uint256",name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"}];var C=[{inputs:[{internalType:"address",name:"",type:"address"}],name:"memberAddressByDelegateKey",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"members",outputs:[{internalType:"address",name:"delegateKey",type:"address"},{internalType:"uint256",name:"shares",type:"uint256"},{internalType:"uint256",name:"loot",type:"uint256"},{internalType:"bool",name:"exists",type:"bool"},{internalType:"uint256",name:"highestIndexYesVote",type:"uint256"},{internalType:"uint256",name:"jailed",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalShares",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"}];var j={1:"https://api.thegraph.com/subgraphs/name/uniswap/uniswap-v2"};var D=[{inputs:[{internalType:"address",name:"",type:"address"}],name:"userInfo",outputs:[{internalType:"uint256",name:"amount",type:"uint256"}],stateMutability:"view",type:"function"}];var _=[{constant:!0,inputs:[{name:"",type:"address"}],name:"issuanceData",outputs:[{name:"initialDebtOwnership",type:"uint256"},{name:"debtEntryIndex",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"}];var M=[{constant:!0,inputs:[{internalType:"address",name:"account",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{internalType:"address",name:"account",type:"address"}],name:"borrowBalanceStored",outputs:[{internalType:"uint256",name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"}];var B={1:"https://api.thegraph.com/subgraphs/name/creamfinancedev/cream-swap-v2",3:"https://api.thegraph.com/subgraphs/name/creamfinancedev/cream-swap-dev"},A=[{constant:!0,inputs:[{internalType:"address",name:"account",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"}];function I(e,t,n,a){return f(this,void 0,void 0,(function(){var r,s,o;return h(this,(function(c){switch(c.label){case 0:return r={poolShares:{__args:{where:{userAddress_in:t.map((function(e){return e.toLowerCase()})),balance_gt:0},first:1e3,orderBy:"balance",orderDirection:"desc"},userAddress:{id:!0},balance:!0,poolId:{totalShares:!0,tokens:{id:!0,balance:!0}}}},"latest"!==a&&(r.poolShares.__args.block={number:a}),[4,N(B[e],r)];case 1:return s=c.sent(),o={},s&&s.poolShares&&s.poolShares.forEach((function(e){return e.poolId.tokens.map((function(t){if(t.id.split("-")[1]===n.toLowerCase()){var a=i.getAddress(e.userAddress.id);o[a]||(o[a]=0),o[a]=o[a]+t.balance/e.poolId.totalShares*e.balance}}))})),[2,o||{}]}}))}))}function P(e,t,n,a,r){return f(this,void 0,void 0,(function(){var s,i,c,u,p,l,d;return h(this,(function(f){switch(f.label){case 0:for(s="number"==typeof r?r:"latest",i=a.pools.length,c=n.length,u=[],p=function(e){u.push.apply(u,n.map((function(t){return[a.pools[e].address,"balanceOf",[t]]})))},l=0;l<i;l++)p(l);return[4,H(e,t,A,u,{blockTag:s})];case 1:return d=f.sent(),[2,Object.fromEntries(n.map((function(e,t){for(var n=0,a=0;a<i;a++)n+=parseFloat(o.formatUnits(d[t+a*c].toString(),18));return[e,n]})))]}}))}))}var F={balancer:function(e,t,n,a,r,s){return f(this,void 0,void 0,(function(){var e,n,o;return h(this,(function(c){switch(c.label){case 0:return e={poolShares:{__args:{where:{userAddress_in:a.map((function(e){return e.toLowerCase()})),balance_gt:0},first:1e3,orderBy:"balance",orderDirection:"desc"},userAddress:{id:!0},balance:!0,poolId:{totalShares:!0,tokens:{id:!0,balance:!0}}}},"latest"!==s&&(e.poolShares.__args.block={number:s}),[4,N(b[t],e)];case 1:return n=c.sent(),o={},n&&n.poolShares&&n.poolShares.forEach((function(e){return e.poolId.tokens.map((function(t){if(t.id.split("-")[1]===r.address.toLowerCase()){var n=i.getAddress(e.userAddress.id);o[n]||(o[n]=0),o[n]=o[n]+t.balance/e.poolId.totalShares*e.balance}}))})),[2,o||{}]}}))}))},"contract-call":function(e,t,n,a,r,s){return f(this,void 0,void 0,(function(){var e,i;return h(this,(function(c){switch(c.label){case 0:return e="number"==typeof s?s:"latest",[4,H(t,n,[r.methodABI],a.map((function(e){return[r.address,r.methodABI.name,v(r,e)]})),{blockTag:e})];case 1:return i=c.sent(),[2,Object.fromEntries(i.map((function(e,t){return[a[t],parseFloat(o.formatUnits(e.toString(),r.decimals))]})))]}}))}))},"erc20-balance-of":w,"erc20-balance-of-fixed-total":function(e,t,n,a,r,s){return f(this,void 0,void 0,(function(){var e,i;return h(this,(function(o){switch(o.label){case 0:return[4,w(0,t,n,a,r,s)];case 1:return e=o.sent(),i=Object.values(e).reduce((function(e,t){return e+t}),0),[2,Object.fromEntries(Object.entries(e).map((function(e){return[e[0],r.total*e[1]/i]})))]}}))}))},"erc20-balance-of-cv":function(e,t,n,a,r,s){return f(this,void 0,void 0,(function(){var e;return h(this,(function(i){switch(i.label){case 0:return[4,w(0,t,n,a,r,s)];case 1:return e=i.sent(),[2,Object.fromEntries(Object.entries(e).map((function(e){return[e[0],Math.sqrt(e[1])]})))]}}))}))},"erc20-balance-of-coeff":function(e,t,n,a,r,s){return f(this,void 0,void 0,(function(){var e;return h(this,(function(i){switch(i.label){case 0:return[4,w(0,t,n,a,r,s)];case 1:return e=i.sent(),[2,Object.fromEntries(Object.entries(e).map((function(e){return[e[0],e[1]*r.coeff]})))]}}))}))},"erc20-with-balance":function(e,t,n,a,r,s){return f(this,void 0,void 0,(function(){var e;return h(this,(function(i){switch(i.label){case 0:return[4,w(0,t,n,a,r,s)];case 1:return e=i.sent(),[2,Object.fromEntries(Object.entries(e).map((function(e){return[e[0],e[1]>(r.minBalance||0)?1:0]})))]}}))}))},"erc20-balance-of-delegation":function(e,t,n,a,r,s){return f(this,void 0,void 0,(function(){var i,o;return h(this,(function(c){switch(c.label){case 0:return[4,k(e,t,0,a,0,s)];case 1:return i=c.sent(),0===Object.keys(i).length?[2,{}]:(console.debug("Delegations",i),[4,w(0,t,n,Object.values(i).reduce((function(e,t){return e.concat(t)})),r,s)]);case 2:return o=c.sent(),console.debug("Delegators score",o),[2,Object.fromEntries(a.map((function(e){return[e,i[e]?i[e].reduce((function(e,t){return e+o[t]}),0):0]})))]}}))}))},"eth-balance":function(e,t,n,a,r,s){return f(this,void 0,void 0,(function(){var e,r;return h(this,(function(i){switch(i.label){case 0:return e="number"==typeof s?s:"latest",[4,H(t,n,y,a.map((function(e){return[V[t],"getEthBalance",[e]]})),{blockTag:e})];case 1:return r=i.sent(),[2,Object.fromEntries(r.map((function(e,t){return[a[t],parseFloat(o.formatUnits(e.toString(),18))]})))]}}))}))},"maker-ds-chief":function(e,t,n,a,r,s){return f(this,void 0,void 0,(function(){var e,i;return h(this,(function(c){switch(c.label){case 0:return e="number"==typeof s?s:"latest",[4,H(t,n,x,a.map((function(e){return[T[t],"deposits",[e]]})),{blockTag:e})];case 1:return i=c.sent(),[2,Object.fromEntries(i.map((function(e,t){return[a[t],parseFloat(o.formatUnits(e.toString(),r.decimals))]})))]}}))}))},uni:function(e,t,n,a,r,s){return f(this,void 0,void 0,(function(){var e,i;return h(this,(function(c){switch(c.label){case 0:return e="number"==typeof s?s:"latest",[4,H(t,n,S,a.map((function(n){return[E[t],"getCurrentVotes",[n.toLowerCase()],{blockTag:e}]})))];case 1:return i=c.sent(),[2,Object.fromEntries(i.map((function(e,t){return[a[t],parseFloat(o.formatUnits(e.toString(),r.decimals))]})))]}}))}))},"yearn-vault":function(e,t,n,a,r,s){return f(this,void 0,void 0,(function(){var e,i,c,u;return h(this,(function(p){switch(p.label){case 0:return e="number"==typeof s?s:"latest",[4,Promise.all([w(0,t,n,a,r,s),H(t,n,O,[[r.address,"getPricePerFullShare",[]]],{blockTag:e})])];case 1:return i=p.sent(),c=i[0],u=i[1][0],u=parseFloat(o.formatUnits(u.toString(),18)),[2,Object.fromEntries(Object.entries(c).map((function(e){return[e[0],e[1]*u]})))]}}))}))},moloch:function(e,t,n,a,r,s){return f(this,void 0,void 0,(function(){var e,i,c;return h(this,(function(u){switch(u.label){case 0:return e="number"==typeof s?s:"latest",[4,H(t,n,C,a.map((function(e){return[r.address,"memberAddressByDelegateKey",[e]]})),{blockTag:e})];case 1:return i=u.sent(),[4,H(t,n,C,i.filter((function(e){return"0x0000000000000000000000000000000000000000"!==e.toString()})).map((function(e){return[r.address,"members",[e.toString()]]})),{blockTag:e})];case 2:return c=u.sent(),[2,Object.fromEntries(c.map((function(e,t){return[a[t],parseFloat(o.formatUnits(e.shares.toString(),r.decimals))]})))]}}))}))},uniswap:function(e,t,n,a,r,s){return f(this,void 0,void 0,(function(){var e,n,o,c;return h(this,(function(u){switch(u.label){case 0:return e={users:{__args:{where:{id_in:a.map((function(e){return e.toLowerCase()}))},first:1e3},id:!0,liquidityPositions:{__args:{where:{liquidityTokenBalance_gt:0}},liquidityTokenBalance:!0,pair:{id:!0,token0:{id:!0},reserve0:!0,token1:{id:!0},reserve1:!0,totalSupply:!0}}}},"latest"!==s&&(e.users.liquidityPositions.__args.block={number:s}),n=r.address.toLowerCase(),[4,N(j[t],e)];case 1:return o=u.sent(),c={},o&&o.users&&o.users.forEach((function(e){e.liquidityPositions.filter((function(e){return e.pair.token0.id==n||e.pair.token1.id==n})).forEach((function(t){var a=t.pair.reserve0/t.pair.totalSupply,r=t.pair.reserve1/t.pair.totalSupply,s=t.pair.token0.id==n?a*t.liquidityTokenBalance:r*t.liquidityTokenBalance,o=i.getAddress(e.id);c[o]||(c[o]=0),c[o]=c[o]+s}))})),[2,c||{}]}}))}))},pancake:function(e,t,n,a,r,s){return f(this,void 0,void 0,(function(){var e,i,c;return h(this,(function(u){switch(u.label){case 0:return e="number"==typeof s?s:"latest",[4,w(0,t,n,a,r,s)];case 1:return i=u.sent(),[4,Promise.all(r.chefAddresses.map((function(r){return H(t,n,D,a.map((function(t){return[r,"userInfo",[t],{blockTag:e}]})),{blockTag:e})})))];case 2:return c=u.sent(),[2,Object.fromEntries(Object.entries(i).map((function(e,t){return[e[0],e[1]+c.reduce((function(e,n){return e+parseFloat(o.formatUnits(n[t].amount.toString(),r.decimals))}),0)]})))]}}))}))},synthetix:function(e,t,n,a,r,s){return f(this,void 0,void 0,(function(){var e,r,i;return h(this,(function(c){switch(c.label){case 0:return e="number"==typeof s?s:"latest",[4,H(t,n,_,a.map((function(e){return["0x4b9Ca5607f1fF8019c1C6A3c2f0CC8de622D5B82","issuanceData",[e]]})),{blockTag:e})];case 1:return r=c.sent(),i=function(e){var t=1e5*e;return console.log("scaledValue",t),Math.sqrt(t)},[2,Object.fromEntries(r.map((function(e,t){return[a[t],i(parseFloat(o.formatUnits(e.initialDebtOwnership.toString(),27)))]})))]}}))}))},ctoken:function(e,t,n,a,r,s){return f(this,void 0,void 0,(function(){var e,i,c,u,p,l,d,f,m,y,b,v,g,w,k,T;return h(this,(function(h){switch(h.label){case 0:return e="number"==typeof s?s:"latest","number"!=typeof s?[3,1]:(c=s-r.offsetCheck,[3,3]);case 1:return[4,n.getBlockNumber()];case 2:c=h.sent()-r.offsetCheck,h.label=3;case 3:return i=c,u=a.map((function(e){return[r.address,"balanceOf",[e]]})),p=a.map((function(e){return[r.address,"borrowBalanceStored",[e]]})),l=u.concat(p),[4,Promise.all([H(t,n,M,l,{blockTag:e}),H(t,n,M,a.map((function(e){return[r.address,"balanceOf",[e]]})),{blockTag:i})])];case 4:for(d=h.sent(),f=d[0],m=d[1],y=f.slice(0,a.length),b=f.slice(a.length),v={},g=0;g<y.length;g++)w=1,r.borrowingRestricted&&(w=0==b[g].toString().localeCompare("0")?1:0),k=parseFloat(o.formatUnits(y[g].toString(),r.decimals)),T=parseFloat(o.formatUnits(m[g].toString(),r.decimals)),v[a[g]]=Math.min(k,T)*w;return[2,v]}}))}))},cream:function(e,t,n,a,r,s){return f(this,void 0,void 0,(function(){var e,i,o,c,u,p,l,d,f;return h(this,(function(h){switch(h.label){case 0:return e=r.address,[4,Promise.all([I(t,a,e,s),P(t,n,a,r,s)])];case 1:for(i=h.sent(),o=i[0],c=i[1],u=0,p=Object.entries(c);u<p.length;u++)l=p[u],d=l[0],f=l[1],o[d]||(o[d]=0),o[d]=o[d]+f;return[2,o||{}]}}))}))}},q={1:{key:"1",name:"Ethereum Mainnet",chainId:1,network:"homestead",rpc:[{url:"https://api-geth-archive.ankr.com",user:"balancer_user",password:"balancerAnkr20201015"},"https://eth-mainnet.alchemyapi.io/v2/4bdDVB5QAaorY2UE-GBUbM2yQB3QJqzv","https://eth-archival.gateway.pokt.network/v1/5f76124fb90218002e9ce985","https://cloudflare-eth.com"],ws:["wss://eth-mainnet.ws.alchemyapi.io/v2/4bdDVB5QAaorY2UE-GBUbM2yQB3QJqzv"],explorer:"https://etherscan.io"},4:{key:"4",name:"Ethereum Testnet Rinkeby",chainId:4,network:"rinkeby",rpc:["https://eth-rinkeby.alchemyapi.io/v2/twReQE9Px03E-E_N_Fbb3OVF7YgHxoGq","https://eth-rinkeby.gateway.pokt.network/v1/5f76124fb90218002e9ce985"],ws:["wss://eth-rinkeby.ws.alchemyapi.io/v2/twReQE9Px03E-E_N_Fbb3OVF7YgHxoGq"],explorer:"https://rinkeby.etherscan.io"},7:{key:"7",name:"ThaiChain",chainId:7,network:"mainnet",rpc:["https://rpc.dome.cloud"],ws:["wss://ws.dome.cloud"],explorer:"https://exp.tch.in.th"},42:{key:"42",name:"Ethereum Testnet Kovan",chainId:42,network:"kovan",rpc:["https://eth-kovan.alchemyapi.io/v2/QCsM2iU0bQ49eGDmZ7-Y--Wpu0lVWXSO","https://poa-kovan.gateway.pokt.network/v1/5f76124fb90218002e9ce985"],ws:["wss://eth-kovan.ws.alchemyapi.io/v2/QCsM2iU0bQ49eGDmZ7-Y--Wpu0lVWXSO"],explorer:"https://kovan.etherscan.io"},56:{key:"56",name:"Binance Smart Chain Mainnet",chainId:56,network:"mainnet",rpc:["https://bsc-dataseed1.binance.org","https://bsc-dataseed2.binance.org","https://bsc-dataseed3.binance.org"],explorer:"https://bscscan.com"},61:{key:"61",name:"Ethereum Classic Mainnet",chainId:61,network:"mainnet",rpc:["https://ethereumclassic.network"],explorer:"https://blockscout.com/etc/mainnet"},97:{key:"97",name:"Binance Smart Chain Testnet",chainId:97,network:"testnet",rpc:["https://data-seed-prebsc-1-s1.binance.org:8545"],explorer:"https://testnet.bscscan.com"},100:{key:"100",name:"xDAI Chain",chainId:100,network:"mainnet",rpc:["https://xdai-archive.blockscout.com","https://poa-xdai.gateway.pokt.network/v1/5f76124fb90218002e9ce985"],ws:["wss://rpc.xdaichain.com/wss"],explorer:"https://blockscout.com/poa/xdai"},137:{key:"137",name:"Matic Mainnet",chainId:137,network:"mainnet",rpc:["https://rpc-mainnet.matic.network"],ws:["wss://ws-mainnet.matic.network"],explorer:""},420:{key:"420",name:"Optimistic Ethereum",chainId:420,network:"mainnet",explorer:""},32659:{key:"32659",name:"Fusion Mainnet",chainId:32659,network:"mainnet",rpc:["https://vote.anyswap.exchange/mainnet"],ws:["wss://mainnetpublicgateway1.fusionnetwork.io:10001"],explorer:"https://fsnex.com"},80001:{key:"80001",name:"Matic Mumbai",chainId:80001,network:"testnet",rpc:["https://rpc-mumbai.matic.today"],ws:["wss://ws-mumbai.matic.today"],explorer:""},wanchain:{key:"wanchain",name:"Wanchain",chainId:1,network:"mainnet",rpc:["https://gwan-ssl.wandevs.org:56891"],ws:["wss://api.wanchain.org:8443/ws/v3/ddd16770c68f30350a21114802d5418eafe039b722de52b488e7eee1ee2cd73f"],explorer:"https://www.wanscan.org"}},L={};var U=["ipns-ns","ipfs-ns","swarm-ns","onion","onion3"],Q=[{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"resolver",outputs:[{name:"resolverAddress",type:"address"}],payable:!1,stateMutability:"view",type:"function"}],R=[{constant:!0,inputs:[{internalType:"bytes32",name:"node",type:"bytes32"}],name:"contenthash",outputs:[{internalType:"bytes",name:"",type:"bytes"}],payable:!1,stateMutability:"view",type:"function"}];var V={1:"0xeefba1e63905ef1d7acba5a8513c70307c1ce441",4:"0x42ad527de7d4e9d9d011ac45b31d8551f8fe9821",5:"0x77dca2c955b15e9de4dbbcf1246b4b85b651e50e",6:"0x53c43764255c17bd724f74c4ef150724ac50a3ed",42:"0x2cc8688c5f75e365aaeeb4ea8d6a480405a48d2a",56:"0x1ee38d535d541c55c9dae27b12edf090c608e6fb",97:"0x8b54247c6BAe96A6ccAFa468ebae96c4D7445e46",100:"0xb5b692a88bdfc81ca69dcb1d924f59f0413a602a",wanchain:"0xba5934ab3056fca1fa458d30fbb3810c3eb5145f"},G={1:"https://api.thegraph.com/subgraphs/name/snapshot-labs/snapshot",4:"https://api.thegraph.com/subgraphs/name/snapshot-labs/snapshot-rinkeby",42:"https://api.thegraph.com/subgraphs/name/snapshot-labs/snapshot-kovan"};function z(e,t,n,r){return f(this,void 0,void 0,(function(){var s,i,o;return h(this,(function(c){switch(c.label){case 0:s=new a.Contract(n[0],t,e),c.label=1;case 1:return c.trys.push([1,3,,4]),i=n[2]||[],[4,s[n[1]].apply(s,m(i,[r||{}]))];case 2:return[2,c.sent()];case 3:return o=c.sent(),[2,Promise.reject(o)];case 4:return[2]}}))}))}function H(e,t,r,s,i){return f(this,void 0,void 0,(function(){var o,c,u;return h(this,(function(p){switch(p.label){case 0:o=new a.Contract(V[e],y,t),c=new n.Interface(r),p.label=1;case 1:return p.trys.push([1,3,,4]),[4,o.aggregate(s.map((function(e){return[e[0].toLowerCase(),c.encodeFunctionData(e[1],e[2])]})),i||{})];case 2:return u=p.sent(),[2,u[1].map((function(e,t){return c.decodeFunctionResult(s[t][1],e)}))];case 3:return p.sent(),[2,Promise.reject()];case 4:return[2]}}))}))}function N(e,t){return f(this,void 0,void 0,(function(){return h(this,(function(n){switch(n.label){case 0:return[4,fetch(e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({query:r.jsonToGraphQLQuery({query:t})})})];case 1:return[4,n.sent().json()];case 2:return[2,n.sent().data||{}]}}))}))}function Y(e,t,n,r,s,i){return void 0===i&&(i={}),f(this,void 0,void 0,(function(){var o,c,u;return h(this,(function(p){switch(p.label){case 0:return o=e.getSigner(),c=new a.Contract(t,n,e),[4,(u=c.connect(o))[r].apply(u,m(s,[i]))];case 1:return[2,p.sent()]}}))}))}var W={call:z,multicall:H,subgraphRequest:N,ipfsGet:function(e,t,n){return void 0===n&&(n="ipfs"),f(this,void 0,void 0,(function(){return h(this,(function(a){return[2,fetch("https://"+e+"/"+n+"/"+t).then((function(e){return e.json()}))]}))}))},sendTransaction:Y,getScores:function(e,t,n,a,r,s){return void 0===s&&(s="latest"),f(this,void 0,void 0,(function(){return h(this,(function(i){switch(i.label){case 0:return[4,Promise.all(t.map((function(t){return F[t.name](e,n,a,r,t.params,s)})))];case 1:return[2,i.sent()]}}))}))},validateSchema:function(e,t){var n=(new s).compile(e),a=n(t);return a||n.errors},getProvider:function(e){var t=q[e].rpc[0];return L[e]||(L[e]=new c.JsonRpcProvider(t)),L[e]},decodeContenthash:function(e){var t,n,a;if(e.error)return{protocolType:null,decoded:e.error};if(e)try{t=u.decode(e);var r=u.getCodec(e);"ipfs-ns"===r?(t=u.helpers.cidV0ToV1Base32(t),n="ipfs"):"ipns-ns"===r?(t=d.decode(t).slice(2).toString(),n="ipns"):"swarm-ns"===r?n="bzz":"onion"===r?n="onion":"onion3"===r?n="onion3":t=e}catch(e){a=e.message}return{protocolType:n,decoded:t,error:a}},validateContent:function(e){return u.isHashOfType(e,u.Types.ipfs)||u.isHashOfType(e,u.Types.swarm)},isValidContenthash:function(e){try{var t=u.getCodec(e);return l.isHexString(e)&&U.includes(t)}catch(e){console.log(e)}},encodeContenthash:function(e){var t,n,a=!1;if(e){var r=e.match(/^(ipfs|ipns|bzz|onion|onion3):\/\/(.*)/)||e.match(/\/(ipfs)\/(.*)/)||e.match(/\/(ipns)\/(.*)/);r&&(n=r[1],t=r[2]);try{if("ipfs"===n)t.length>=4&&(a="0x"+u.encode("ipfs-ns",t));else if("ipns"===n){var s=d.encode(Buffer.concat([Buffer.from([0,t.length]),Buffer.from(t)]));a="0x"+u.encode("ipns-ns",s)}else"bzz"===n?t.length>=4&&(a="0x"+u.fromSwarm(t)):"onion"===n?16==t.length&&(a="0x"+u.encode("onion",t)):"onion3"===n?56==t.length&&(a="0x"+u.encode("onion3",t)):console.warn("Unsupported protocol or invalid value",{contentType:n,text:e})}catch(t){console.warn("Error encoding content hash",{text:e,encoded:a})}}return a},resolveENSContentHash:function(e,t){return f(this,void 0,void 0,(function(){var n,a;return h(this,(function(r){switch(r.label){case 0:return n=p.namehash(e),[4,z(t,Q,["0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e","resolver",[n]])];case 1:return a=r.sent(),[4,z(t,R,[a,"contenthash",[n]])];case 2:return[2,r.sent()]}}))}))}},J={1:"https://api.thegraph.com/subgraphs/name/aragon/aragon-govern-mainnet",4:"https://api.thegraph.com/subgraphs/name/evalir/aragon-govern-rinkeby"},K=[{inputs:[{components:[{components:[{internalType:"uint256",name:"nonce",type:"uint256"},{internalType:"uint256",name:"executionTime",type:"uint256"},{internalType:"address",name:"submitter",type:"address"},{internalType:"contract IERC3000Executor",name:"executor",type:"address"},{components:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],internalType:"struct ERC3000Data.Action[]",name:"actions",type:"tuple[]"},{internalType:"bytes32",name:"allowFailuresMap",type:"bytes32"},{internalType:"bytes",name:"proof",type:"bytes"}],internalType:"struct ERC3000Data.Payload",name:"payload",type:"tuple"},{components:[{internalType:"uint256",name:"executionDelay",type:"uint256"},{components:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],internalType:"struct ERC3000Data.Collateral",name:"scheduleDeposit",type:"tuple"},{components:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],internalType:"struct ERC3000Data.Collateral",name:"challengeDeposit",type:"tuple"},{internalType:"address",name:"resolver",type:"address"},{internalType:"bytes",name:"rules",type:"bytes"}],internalType:"struct ERC3000Data.Config",name:"config",type:"tuple"}],internalType:"struct ERC3000Data.Container",name:"_container",type:"tuple"}],name:"schedule",outputs:[{internalType:"bytes32",name:"containerHash",type:"bytes32"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"nonce",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"}],$={registryEntry:{__args:{id:void 0},executor:{address:!0},queue:{address:!0,config:{executionDelay:!0,scheduleDeposit:{token:!0,amount:!0},challengeDeposit:{token:!0,amount:!0},resolver:!0,rules:!0}}}};function X(n,a,r,s,i,o){return f(this,void 0,void 0,(function(){var c,u,p,l,d,f,m;return h(this,(function(h){switch(h.label){case 0:return(c=$).registryEntry.__args.id=r,[4,N(J[n],c)];case 1:return u=h.sent(),p=u.registryEntry.queue.config,[4,z(a,K,[u.registryEntry.queue.address,"nonce"])];case 2:return l=h.sent(),d=new e(l.toString()),f=d.add(new e("1")),m=Math.round(Date.now()/1e3)+Number(p.executionDelay)+60,[4,Y(a,u.registryEntry.queue.address,K,"schedule",[{payload:{nonce:f.toString(),executionTime:m,submitter:s,executor:u.registryEntry.executor.address,actions:o,allowFailuresMap:"0x0000000000000000000000000000000000000000000000000000000000000000",proof:i?t.toUtf8Bytes(i):"0x00"},config:{executionDelay:p.executionDelay,scheduleDeposit:{token:p.scheduleDeposit.token,amount:p.scheduleDeposit.amount},challengeDeposit:{token:p.challengeDeposit.token,amount:p.challengeDeposit.amount},resolver:p.resolver,rules:p.rules}}],{gasLimit:5e5})];case 3:return[2,h.sent()]}}))}))}var Z={aragon:function(){function e(){this.author="Evalir",this.version="0.1.3",this.name="Aragon Govern",this.website="https://aragon.org/blog/snapshot"}return e.prototype.action=function(e,t,n,a,r,s){return f(this,void 0,void 0,(function(){var i,o;return h(this,(function(c){switch(c.label){case 0:return c.trys.push([0,3,,4]),[4,t.listAccounts()];case 1:return i=c.sent()[0],[4,X(e,t,n.id,i,r,a["choice"+s].actions)];case 2:return[2,c.sent()];case 3:return o=c.sent(),console.error(o),[3,4];case 4:return[2]}}))}))},e}()},ee={space:{$schema:"http://json-schema.org/draft-07/schema#",$ref:"#/definitions/Space",definitions:{Space:{title:"Space",type:"object",properties:{name:{type:"string",title:"name",maxLength:32},network:{type:"string",title:"network",maxLength:32},symbol:{type:"string",title:"symbol",maxLength:12},skin:{type:"string",title:"skin",maxLength:32},domain:{type:"string",title:"domain",maxLength:64},strategies:{type:"array",minItems:1,maxItems:3,items:{type:"object",properties:{name:{type:"string",maxLength:64,title:"name"},params:{type:"object",title:"params"}},required:["name"],additionalProperties:!1},title:"strategies"},members:{type:"array",items:{type:"string",maxLength:64},title:"members"},filters:{type:"object",properties:{defaultTab:{type:"string"},minScore:{type:"number",minimum:0},onlyMembers:{type:"boolean"},invalids:{type:"array",items:{type:"string",maxLength:64},title:"invalids"}},additionalProperties:!1}},required:["name","network","symbol","strategies"],additionalProperties:!1}}}.definitions.Space};return{plugins:Z,strategies:F,schemas:ee,utils:W}}(BN,strings,abi$9,contracts,jsonToGraphqlQuery,Ajv,address,units,providers$1,contentHash,hash,bytes,bs58);
